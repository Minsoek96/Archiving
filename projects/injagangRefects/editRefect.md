# EDIT? : ìê¸°ì†Œê°œì„œ ì‘ì„± & í¸ì§‘

í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ëŠ” ìœ ì €ì˜ ìì†Œì„œ ë¦¬ìŠ¤íŠ¸ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

- EDITë¼ëŠ” ëª…ì¹­ì€ ì˜ë¯¸ë¥¼ íŒŒì•…í•˜ê¸° í˜ë“¤ì—ˆìŠµë‹ˆë‹¤.
- ì´ì „ ë¬¸ì œì™€ ë™ì¼í•˜ê²Œ ì»´í¬ë„ŒíŠ¸ì˜ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ & ë§¤ì§ë„˜ë²„ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.
- Propsë“œë¦´ë§ ë¬¸ì œë„ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

## ìƒì„¸ ë¬¸ì œì  íŒŒì•…

- í‘œí˜„ì´ ì• ë§¤í•œ ë„ë©”ì¸ëª…
  - EDIT : í¸ì§‘ ë¬´ì—‡ì„ í¸ì§‘?
- ë³µì¡í•œ í˜ì´ì§€ ë¼ìš°íŒ… êµ¬ì¡° & ëª…ì¹­
  - myEssay : ìì†Œì„œ í™•ì¸ í˜ì´ì§€
  - edit : ìì†Œì„œ ì‘ì„± í˜ì´ì§€ ë¼ìš°íŒ…
  - edit essay=2 : ìì†Œì„œ ìˆ˜ì • í˜ì´ì§€
- idxë¡œ ì´ë£¨ì–´ì§„ map í‚¤ê°’

## EDIT í•´ê²° ë°©ì•ˆ

- ëŒ€í‘œ ë„ë©”ì¸ëª… ìˆ˜ì •
  - coverLetter: ìê¸°ì†Œê°œì„œ
- ë³µì¡í•œ ë¼ìš°íŒ… & ëª…ì¹­ ê°œì„ 
  - coverLetter : ìì†Œì„œ í™•ì¸ í˜ì´ì§€
  - coverLetter/new : ìì†Œì„œ ì‘ì„± í˜ì´ì§€
  - coverLetter/[id]/edit: ìì†Œì„œ í¸ì§‘ í˜ì´ì§€
- ì»´í¬ë„ŒíŠ¸ ê´€ì‹¬ì‚¬ ë¶„ë¥˜
- UUID4()ë¥¼ í‚¤ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸°
- íŠ¸ë¦¬ê°€ ê¹Šì€ ê²½ìš° ë¦¬ë•ìŠ¤ í™œìš©

## ìê¸°ì†Œê°œì„œ ë¦¬íŒ©í† ë§ ì ìš©ì „

### ìœ ì € ìì†Œì„œ ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬

- ìœ ì €ê°€ ì„ íƒí•œ ìì†Œì„œ ë„˜ë²„ ìƒíƒœë¥¼ ê´€ë¦¬ í•˜ê¸° ìœ„í•œ ë¡œì§ì´ Propsë“œë¦´ë§ êµ¬ì¡°ì˜ ì£¼ìš” ì›ì¸ì´ë¼ íŒë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.

### ìœ ì € ìì†Œì„œ ìƒì„± & í¸ì§‘

> ìƒì„±ê³¼ í¸ì§‘ì˜ ìŠ¤íƒ€ì¼ì´ë‚˜ ë¡œì§ì´ ë¹„ìŠ·í•˜ë‹¤ëŠ” ì´ìœ ë¡œ í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì´ë¥¼ ì²˜ë¦¬í•˜ë ¤ í–ˆë˜ ì•ˆì¼í•œ ì ‘ê·¼ì´ ë¬¸ì œì˜€ìŠµë‹ˆë‹¤.

- `isEdit` ìƒíƒœì— ëŒ€í•œ ì˜ì¡´ë„ê°€ ë†’ì•„ì ¸ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê³  ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ì—ì„œ ë¹„íš¨ìœ¨ì ì´ì—ˆìŠµë‹ˆë‹¤.
- ì‚¼í•­ ì—°ì‚°ìë¥¼ ì´ìš©í•˜ì—¬ ê¸°ëŠ¥ì„ ë¶„ë¥˜í•˜ëŠ” ë°©ì‹ì€ ì ˆì°¨ì ì¸ ì„±í–¥ì˜ ì½”ë“œì— ê°€ê¹Œì›Œ ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ì˜ì¡´ë„ë¥¼ ë†’ì´ê³  ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ì—ì„œ ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë©° ê°€ë…ì„±ì„ ë–¨ì–´íŠ¸ë ¸ìŠµë‹ˆë‹¤.

---

[ `í•´ê²°ë°©ì•ˆ`]

- **ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬**: ìƒì„± ê¸°ëŠ¥ê³¼ í¸ì§‘ ê¸°ëŠ¥ì„ ë³„ë„ì˜ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
  ì»¤ìŠ¤í…€ í›… í™œìš©: ë¹„ìŠ·í•˜ê³  ê²¹ì¹˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì»¤ìŠ¤í…€ í›…ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ìƒíƒœ ê´€ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.
- **ëª…ì¹­ ë³€ê²½**: `handle ~~` í˜•íƒœì˜ ë¶ˆëª…í™•í•œ ëª…ì¹­ì„ ìµœëŒ€í•œ ì§ê´€ì ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ìŠµë‹ˆë‹¤.
- **ê³ ìœ  í‚¤ ê°’ ì‚¬ìš©**: ì„œë²„ì—ì„œ id ê°’ì„ ì§€ì •í•´ì£¼ê¸° ë•Œë¬¸ì— key ê°’ì— í¬ê²Œ ì‹ ê²½ ì“°ì§€ ì•Šì•˜ìœ¼ë‚˜, CRUD ê´€ë ¨ ì»´í¬ë„ŒíŠ¸ì˜ ë§µí•‘ì—ì„œëŠ” key ê°’ì„ ìœ ë‹ˆí¬í•œ ê°’ìœ¼ë¡œ ì§€ì •í•˜ëŠ” ê²ƒì´ ì˜³ë‹¤ê³  íŒë‹¨í•˜ì—¬ `uuid4()`ë¥¼ ì±„íƒí•˜ì˜€ìŠµë‹ˆë‹¤.

### EDIT ë¦¬íŒ©í† ë§ ì ìš©ì „ ì½”ë“œ

<!-- markdownlint-disable MD033 -->

<details>
  <summary>ë¦¬íŒ©í† ë§ì „ ì½”ë“œ </summary>

```jsx
type QnAEditorProps = {
  isEdit: boolean;
};

const QnAEditor = ({ isEdit }: QnAEditorProps) => {
  {
    /**ë¦¬ë•ìŠ¤ì— ëŒ€í•œ ì„ ì–¸ */
  }
  const router = useRouter();
  const dispatch = useDispatch();
  /**ë‚˜ì˜ ìì†Œì„œë¥¼ í˜¸ì¶œì¤‘ íŒë‹¨ì—¬ë¶€ */
  const readEssayLoading = useSelector(
    (state: RootReducerType) => state.essay.loading,
  );
  /**ë‚˜ì˜ ìì†Œì„œ ë¦¬ìŠ¤íŠ¸ */
  const readEssayList = useSelector(
    (state: RootReducerType) => state.essay.readEssayList,
  );
  /**ê´€ë¦¬ìì˜ ìƒ˜í”Œ ë¦¬ìŠ¤íŠ¸ */
  const templateReducer: InitiaState = useSelector(
    (state: RootReducerType) => state.template,
  );

  const [qnaLists, setQnALists] = useState<QnAList[]>([]);
  const [templateTitle, setTemplateTitle] = useState<string>("ì»¤ìŠ¤í…€ìì†Œì„œ");
  const [mainTitle, setMainTitle] = useState<string>("");
  const [qnaContent, setQnAContent] = useState<qnaList>([]);
  const [isOpenModal, setIsOpenModal] = useState<boolean>(false);
  const [modalMsg, setModalMsg] = useState<string>("");
  const essayId = isEdit
    ? (JSON.parse(router.query.essayId as string) as number)
    : 0;

  /** ESSAYì˜ ë¡œë”©ì´ ì™„ë£Œê°€ë˜ë©´ useStateì— ë°˜ì˜í•œë‹¤. */
  useEffect(() => {
    if (!readEssayLoading) {
      if (readEssayList[0].title === "") {
        return;
      }
      setQnALists(readEssayList);
      setTemplateTitle(readEssayList[0]?.title);
    }
  }, [readEssayLoading]);

  /** í…œí”Œë¦¿ì˜ ë¡œë”©ì´ ì™„ë£Œê°€ë˜ë©´ useStateì— ë°˜ì˜í•œë‹¤. */
  useEffect(() => {
    if (!templateReducer.loading) {
      const customTemplate = {
        templateId: 10000,
        title: "ì»¤ìŠ¤í…€ìì†Œì„œ",
        qnaList: [],
      };
      setQnALists(cur => [customTemplate, ...templateReducer.templateList]);
    }
  }, [templateReducer.templateList]);
  /** ìˆ˜ì •ëª¨ë“œì—ì„œëŠ” ê¸°ì¡´ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜, ì‘ì„±ëª¨ë“œì—ì„œëŠ” ì„ íƒëœ í…œí”Œë¦¿ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜ */
  const getQuestionItem = useCallback(() => {
    if (isEdit) {
      return qnaLists;
    }
    const filteItem = qnaLists.filter(list => list.title === templateTitle);
    return filteItem;
  }, [templateTitle, qnaLists]);

  const handleChangeMainTitle = (title: string) => {
    setMainTitle(title);
  };

  /**ì§ˆë¬¸FORM ì¶”ê°€ í•¨ìˆ˜ */
  const handleAddQnA = () => {
    if (templateTitle === "") {
      return;
    }
    setQnALists(prevLists => {
      const newLists = [...prevLists];
      const filterIndex = newLists.findIndex(a => a.title === templateTitle);
      const newContent = [...newLists[filterIndex].qnaList, " "];
      newLists[filterIndex].qnaList = newContent;
      return newLists;
    });
  };

  /**í˜„ì¬ ì§ˆë¬¸ë¦¬ìŠ¤íŠ¸ ìˆ˜ì • */
  const handleChangeQnA = (index: number, question: string, answer: string) => {
    const newList = [...qnaContent];
    newList[index].question = question;
    newList[index].answer = answer;
    setQnAContent(newList);
  };

  /**í˜„ì¬ ì§ˆë¬¸ë¦¬ìŠ¤íŠ¸ì˜ ì •ë³´ë¥¼ ì „ë‹¬ */
  const handleQnASelect = (index: number, question: string, answer: string) => {
    const filterList = qnaContent[index];
    if (filterList) {
      return;
    } else {
      setQnAContent(curList => [
        ...curList,
        { qnaId: index, question, answer: answer },
      ]);
    }
  };

  /**í•„í„°ë§í›„ ìì†Œì„œ ì‘ì„± ë°˜ì˜ */
  const handleSubmit = () => {
    const filterJudge = qnaContent.filter(
      a => a.answer === "" || a.question === "",
    ).length;
    if (!isEdit && mainTitle === "") {
      setIsOpenModal(true);
      setModalMsg("ë©”ì¸ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
      return;
    }
    if (qnaContent.length < 1) {
      setIsOpenModal(true);
      setModalMsg("ì§ˆë¬¸ê³¼ ë‹µë³€ì€ 1ê°œì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”.");
      return;
    }
    if (filterJudge > 0) {
      setIsOpenModal(true);
      setModalMsg("ì§ˆë¬¸ ë‹µë³€ì˜ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”");
      return;
    }
    const data = {
      title: isEdit
        ? mainTitle === ""
          ? templateTitle
          : mainTitle
        : mainTitle,
      qnaList: qnaContent,
    };
    if (isEdit) {
      dispatch(updateEssay(data, essayId));
      router.replace("/myEssay");
      return;
    }
    dispatch(addEssay(data, Number(Cookies.get("useId"))));
    router.replace("/myEssay");
  };


  /**ëª¨ë“œ1ì€ ì•¡ì…˜ì´ ì—†ëŠ” ëª¨ë‹¬, ëª¨ë“œ2 ì‚­ì œì•¡ì…˜ì´ ë‹´ê¸´ ëª¨ë‹¬ */
  const handleModal = (mode: number) => {
    if (mode === 1) {
      setIsOpenModal(false);
    }
    if (mode === 2) {
      setModalMsg(`${essayId}ë²ˆ ìì†Œì„œë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
      setIsOpenModal(true);
    }
  };

  /**ìì†Œì„œ ì‚­ì œ*/
  const handleDeleteEssay = () => {
    dispatch(deleteEssayList(essayId));
    router.push("/myEssay");
  };

  return (
    <QnAEditorStyle>
      <h2>{isEdit ? "ìì†Œì„œ ìˆ˜ì •í•˜ê¸°" : "ìì†Œì„œ ì‘ì„±í•˜ê¸°"}</h2>

      <TopContainer>
        <QnAListTitle onChange={handleChangeMainTitle} />
        <ControlMenu
          Size={{ width: `${v.lgItemWidth}`, height: "40px" }}
          value={templateTitle}
          optionList={qnaLists}
          onChange={setTemplateTitle}
        />
        {qnaLists &&
          getQuestionItem().map(list => (
            <QuestionItmesContainer
              key={isEdit ? list.essayId : list.templateId}
            >
              {list.qnaList &&
                list.qnaList.map((qna, idx) => (
                  <QuestionItem
                    key={idx}
                    content={qna}
                    onChange={handleChangeQnA}
                    curInfo={handleQnASelect}
                    index={idx}
                  ></QuestionItem>
                ))}
            </QuestionItmesContainer>
          ))}
      </TopContainer>

      <BottomContainer>
        <BiPlus onClick={handleAddQnA}></BiPlus>
        <ControlButtonContainer>
          <div>
            <CustomButton
              Size={{ width: "150px", font: "20px" }}
              onClick={() => router.push("/myEssay")}
              text="ë’¤ë¡œê°€ê¸°"
            />
          </div>
          <div>
            {isEdit ? (
              <CustomButton
                Size={{ width: "150px", font: "20px" }}
                onClick={() => handleModal(2)}
                text="ì‚­ì œí•˜ê¸°"
              />
            ) : (
              <></>
            )}
            <CustomButton
              Size={{ width: "150px", font: "20px" }}
              onClick={handleSubmit}
              text={isEdit ? "ìˆ˜ì •ì™„ë£Œ" : "ì‘ì„±ì™„ë£Œ"}
            />
          </div>
        </ControlButtonContainer>
      </BottomContainer>

      {isOpenModal && (
        <Modal
          isOpen={isOpenModal}
          onClose={() => handleModal(1)}
          onAction={isEdit ? handleDeleteEssay : () => handleModal(1)}
          contents={{
            title: "ê²½ê³ ",
            content: modalMsg,
          }}
        ></Modal>
      )}
    </QnAEditorStyle>
  );
};

export default QnAEditor;
```

</details>

<!-- markdownlint-enable MD033 -->

- ì£¼ì„ì´ ì—†ìœ¼ë©´ ì´í•´í• ìˆ˜ ì—†ëŠ” ì½”ë“œì™€ êµ¬ì¡°

### ë¦¬íŒ©í† ë§ ì ìš©í›„(ì½”ë“œ ì¼ë¶€)

```jsx
const CoverLetterEdit = () => {
  const [coverLetterTitle, setCoverLetterTitle] = useState < string > "";
  const router = useRouter();
  const moveCoverLetterMainPage = "/coverLetter";
  const { id } = router.query;

  const { qnaList, setQnAList, deleteQnAList, changeQnAList, addQnAList } =
    useCoverLetterCreatorLogic();

  const {
    loading,
    targetQnAData,
    getDetailEssayList,
    coverLetterMainTitle,
    changeCoverLetter,
    deleteCoverLetter,
  } = useCoverLetterManager();

  useEffect(() => {
    getDetailEssayList(Number(id));
  }, []);

  useEffect(() => {
    if (!loading) {
      setQnAList(targetQnAData);
      setCoverLetterTitle(coverLetterMainTitle);
    }
  }, [targetQnAData]);

  if (loading) return <p>ë¡œë”©ì¤‘...</p>;

  return (
    <CoverLetterCreatorContainer>
      <MainTitle>ìì†Œì„œ ìˆ˜ì •í•˜ê¸°</MainTitle>
      <CoverLetterTitle
        value={coverLetterTitle}
        onChange={(e) => setCoverLetterTitle(e.target.value)}
        placeholder="ìì†Œì„œ ì œëª©"
      ></CoverLetterTitle>
      {qnaList.map((qna, i) => (
        <CoverLetterQuestionItems
          key={qna.qnaId}
          item={qna}
          onDelete={deleteQnAList}
          onUpdate={changeQnAList}
        ></CoverLetterQuestionItems>
      ))}
      <BiPlusStyled onClick={addQnAList}></BiPlusStyled>
      <ControllerBtns>
        <CustomButton
          Size={{ width: "150px", font: "20px" }}
          onClick={() => router.push(moveCoverLetterMainPage)}
          text={"ë’¤ë¡œê°€ê¸°"}
        />
        <CustomButton
          Size={{ width: "150px", font: "20px" }}
          onClick={() => deleteCoverLetter(Number(id))}
          text={"ì‚­ì œí•˜ê¸°"}
        />
        <CustomButton
          Size={{ width: "150px", font: "20px" }}
          onClick={() =>
            changeCoverLetter(Number(id), coverLetterTitle, qnaList)
          }
          text={"ìˆ˜ì •ì™„ë£Œ"}
        />
      </ControllerBtns>
    </CoverLetterCreatorContainer>
  );
};

export default CoverLetterEdit;
```

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì™¸ë¶€ë¡œ ë¶„ë¦¬í•˜ì—¬ ê°€ë…ì„±ê³¼ ê´€ë¦¬ê°€ ìš©ì´ í•´ì¡ŒìŠµë‹ˆë‹¤.
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì»¤ìŠ¤í…€í›…ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ì¬ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìƒê²¼ìŠµë‹ˆë‹¤.
- ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ë³€í–ˆìŠµë‹ˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ ìì²´ëŠ” UIë Œë”ë§ê³¼ ê°„ë‹¨í•œ ìƒíƒœê´€ë¦¬ì— ì§‘ì¤‘ë˜ì–´ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì§€ì¼°ìŠµë‹ˆë‹¤.

## ë¦¬íŒ©í† ë§ í›„ êµ¬ì¡°

### ì»´í¬ë„ŒíŠ¸

```bash
ğŸ“¦CoverLetter
â”£ ğŸ“‚edit
â”ƒ â”— ğŸ“œCoverLetterEdit.tsx
â”£ ğŸ“‚hooks
â”ƒ â”£ ğŸ“œuseControlTemplate.ts
â”ƒ â”£ ğŸ“œuseCoverLetterCreatorLogic.ts
â”ƒ â”— ğŸ“œuseCoverLetterManager.ts
â”£ ğŸ“‚new
â”ƒ â”£ ğŸ“œCoverLetterCreator.tsx
â”ƒ â”— ğŸ“œCoverLetterQuestionItems.tsx
â”£ ğŸ“œCoverLetter.tsx
â”£ ğŸ“œCoverLetterItems.tsx
â”£ ğŸ“œCoverLetterList.tsx
â”— ğŸ“œCoverLetterPreView.tsx
```

### ë¼ìš°íŒ…

```bash
ğŸ“¦coverLetter
 â”£ ğŸ“‚new
 â”ƒ â”— ğŸ“œindex.tsx
 â”£ ğŸ“‚[id]
 â”ƒ â”— ğŸ“‚edit
 â”ƒ â”ƒ â”— ğŸ“œindex.tsx
 â”— ğŸ“œindex.tsx
```

### ë¦¬ë•ìŠ¤

```bash
ğŸ“¦Essay
 â”£ ğŸ“‚server
 â”ƒ â”£ ğŸ“œactions.tsx
 â”ƒ â”£ ğŸ“œreducer.tsx
 â”ƒ â”— ğŸ“œtypes.tsx
 â”— ğŸ“‚user
 â”ƒ â”£ ğŸ“œactions.ts
 â”ƒ â”£ ğŸ“œreducer.ts
 â”ƒ â”— ğŸ“œtypes.ts
```
