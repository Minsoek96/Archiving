# 실제로 컴퓨터끼리는 IP주소를 사용해 데이터를 주고 받는다.

3계층(네트워크 계층)은 물리적으로 멀리 떨어진 네트워크 간의 데이터 전송을 담당하며, 발신지에서 착신지까지의 패킷이 올바르게 전달될 경로를 제어하는 역할을 한다.

- 라우터와 같은 네트워크 장비들이 경로를 설정하고
- IP 주소 사용 : 전송 대상 장치의 논리적 위치를 식별하며, WAN 통신 시 공인 IP주소를 사용해 라우팅 수행

## IP주소와 서브넷

![subnet](/dev/network/subnet.png)

1. IP 주소 체계

   - IPv4는 32비트로 이루어진 주소 체계로, 이를 8비트씩 나눠서 4개의 10진수로 표현한다.
     - 192.168.0.1
   - IP 주소는 크게 두 가지 부분으로 나눌 수 있다.
     - 네트워크 부분 : 네트워크 구역을 식별
     - 호스트 부분 : 해당 네트워크 내에서 특정 기기를 식별

2. 서브넷 마스크
   - 서브넷 마스크는 IP 주소에서 어느 부분이 네트워크를 나타내고, 어느 부분이 호스트를 나타내는지를 결정한다.
   - 서브넷 마스크는 32비트로 이루어져 있으며, 네트워크를 식별하는 부분이 1로 채워져 있고, 나머지 호스트 부분이 0으로 채워져 있다.
     - 255.255.255.192는 네트워크 부분이 26비트, 호스트 부분이 6비트인 서브넷 마스크

> 서브넷 마스크를 이용하면 큰 네트워크를 작은 네트워크 대역(서브넷)으로 나누어 사용가능하다. 이렇게 하면 IP주소 자원의 낭비를 줄일 수 있고, 네트워크 관리 효율을 높일 수 있다.

## 공인 IP와 사설 IP

### 공인 IP

- 인터넷 서비스 제공(ISP)가 제공하는 주소로, 전 세계에서 유일한 IP 주소이다.
- 공인 IP는 외부 네트워크와 통신할 수있도록 라우팅이 가능하며, 이를 통해 인터넷 상에서 직접적인 통신을 할 수 있다.
- 이 IP 주소는 각 기기에 위치 정보를 제공하여 네트워크를 식별하고, 인터넷상에서 기기의 위치를 추적할 수 있다.

### 사설 IP

- 내부 네트워크에서만 사용되는 IP
- 여러 네트워크에서 동일한 사설 IP를 사용할 수 있지만, 해당 네트워크 내에서만 유효하다.
- 사설 IP는 NAT(Network Address Translation)을 통해 공인 IP와 통신할 수 있도록 변환되어 인터넷과 상호작용하게 된다.
- 대표적인 사설 IP대역 :
  - 10.0.0.0 ~ 10.255.255.255
  - 172.16.0.0 ~ 172.31.255.255
  - 192.168.0.0 ~ 192.168.255.255

### NAT(Network Adderss Translation)

내부 네트워크와 외부 네트워크 간의 주소를 변환하는 기술

- NAT는 여러개의 내부 장치가 동일한 공인 IP 주소를 공유할 수 있게 해준다.
  - 회사의 모든 컴퓨터가 하나의 공인 IP주소를 통해 인터넷 접속 할 수 있다.
- NAT는 내부 네트워크 구조를 외부에 숨겨주기 떄문에 보안에 기여한다.
- IPv4 주소의 고갈 문제를 해결하는 데 도움을 준다.

#### NAT의 동작방식

1. 내부 장치의 요청
   - 내부 네트워크의 장치가 외부로 나가는 요청을 보낸다.
2. 주소 변환
   - 사설 IP주소를 공인 IP주소로 변환하고 요청 패킷에 해당 공인IP 주소를 넣는다.
3. 응답 수신
   - 외부 서버에서의 응답이 NAT장치로 돌아오면, NAT는 포트 번호와 공인 IP주소를 확인하여 해당 응답을 올바른 내부 장치로 전달한다.

#### NAT의 종류

1. static NAT : 특정 내부 IP주소를 항상 동일한 공인 IP주소에 매핑한다. 주로 서버에 사용된다.
2. Dynamic NAT : 내부 IP 주소를 공인 IP주소 풀에서 임의의로 할당한다.
3. PAT : 다수의 내부의 IP주소가 하나의 공인 IP주소를 공유하고, 포트 번호로 구분하여 구별한다.

### 포트포워딩

특정 포트로 들어오는 트래픽을 지정된 내부 IP주소로 전달하는 기술
