# WWW(웹)을 이용할 때는 이렇게 데이터를 주고 받는다.

## HTTP

Http는 웹에서 클라이언트와 서버 간의 데이터를 주고받기 위한 프로토콜로 주요 특징은 요청(Request)와 응답(Response)라는 구조를 기반으로 한다. HTTP는 1.0버전 부터 시작하여 계속 개선되어 왔다

### HTTP 1.0의 특징와 문제점

![http1.0](/dev/network/http_10.png)

**특징** : HTTP 1.0에서는 한번의 요청마다 새로운 TCP 연결을 맺고 응답 후에는 연결을 끊는다. 하나의 URL에 대해 하나의 TCP 연결이 사용되었다.

**문제점** : 이 단순성으로 인해, 많은 양의 데이터를 전송할 경우 성능 문제가 발생할 수 있다. 예를 들어 하나의 웹페이지에 여러 리소스(이미지, css파일등)이 포함되어 있다면, 각 리소스에 대해 새로운 연결을 맺고 끊어야 하기 때문에 네트워크 대기 시간이 크게 증가하는 원인이 된다.

### HTTP 1.1의

![http1.1](/dev/network/http_11.png)

- **지속 연결(Persistent Connection)**
  - HTTP 1.1에서는 기본적으로 **지속 연결(Keep-Alive)**이 활성화되어 있다. 이는 하나의 TCP 연결을 통해 여러 요청과 응답을 주고받을 수 있다는 의미이다.
  - HTTP 1.1에서는 한 번 연결한 TCP세션을 유지해 여러 리소스를 한꺼번에 요청할 수 있다. 이를 통해 연결을 재사용하여 오버헤드를 줄여 성능을 향상시킨다.

### HTTP요청 구조

- **Request Line(요청라인)**

  - 요청의 첫 번째 줄로, 클라이언트가 서버에 어떤 작업을 요청하는지 나타냄
    - **Method** : 클라이언트가 서버에서 수행하고자 하는 작업의 종류를 나타냄. 예를 들어, `GET`, `POST`, `PUT`, `DELETE` 등이 있다.
    - **URI(Uniform Resource Identifier)** : 요청 대상 리소스의 경로를 나타냄. 예를 들어 `/index.html`
    - **HTTP Version** : 사용 중인 HTTP의 버전

- **Headers**

  - 요청에 대한 추가 정보를 제공하며, 각 헤더는 키: 값 형식으로 나타난다.
    - **Host** : 요청을 받는 서버의 호스트 이름
    - **User-Agent** : 요청을 보낸 클라이언트의 정보
    - **Accept** : 클라이언트가 수락할 수 있는 미디어 타입 (`text/html, application/json`)
    - **Content-Type** : Body에 포함된 데이터의 형식을 나타냄 (`application/json, multipart/form-data`)
    - **Authorization** : 인증 정보( `Authorization : Bearer <token>`)

- **빈 줄(CRLF)**

  - 헤더와 Body 사이의 구분을 위한 빈줄
  - HTTP 요청에서 헤더와 본문을 구분하기 위해 반드시 한줄의 빈줄이 들어가야 한다.

- **Body**
  - 요청의 실제 데이터를 담고 있는 부분으로, 주로 `POST`, `PUT`와 같은 요청에서 사용된다.
    - **JSON 데이터** : `application/json` 형식으로 전송됨
    - **HTML Form데이터** : `application/x-www-form-urlencoded` 또는 `multipart/form-data` 형식으로 전송됨

### MIME 타입

HTTP는 다양한 종류의 데이터 전송할 수 있으며, 이를 정의하는 것이 MIME 타입이다. 예를 들어 텍스트, 이미지, 비디오 등의 파일 형식을 MIME로 정의하여 전송할 수 있다.

### URI(Uniform Resource Identifier)

URI는 웹에서 리소스의 위치를 나타내는 문자열이다.

```bash
scheme://host/path?query#fragment
```

- scheme: 프로토콜을 의미하며, 예를 들어 http, https, ftp 등이 있다.
- host: 주로 도메인 이름이나 IP 주소, 그리고 포트 번호를 포함한다.
- path: 서버 내에서의 자원의 경로를 의미한다.
- query: 클라이언트가 서버로 보낼 추가적인 데이터를 포함한다.
- fragment: 특정 리소스 내에서의 위치를 가리키는 것으로, 예를 들어 웹페이지 내의 특정 섹션을 의미할 수 있다.

### HTTP 응답 구조

- 상태 라인 (Status Line)

  - `HTTP/1.1 200 OK`
  - 상태 라인은 세 가지 요소로 구성된다.

    - **HTTP 버전** : 서버가 사용하는 HTTP 프로토콜의 버전 (HTTP/1.1, HTTP/2)등
    - **상태코드(Status Code)** : 클라이언트의 요청에 대한 처리 결과를 숫자로 나타냄
    - **상태메시지(Reason Phrase)** : 상태 코드를 설명하는 짧은 텍스
      - `OK`,`Not Found`, `Internal Server Error`,

- 헤더 (Header)

  - `Content-Type: text/html`
  - `Content-Length`: 345
  - 헤더는 보통 키와 값으로 구성되며, 응답에 대한 메타데이터를 담고 있다.
    - **Content-Type** : 응답 본문의 콘텐츠 유형을 지정함 (`text/html`, `aplication/json`등)
    - **Content-Length** : 응답 본문의 길이를 바이트 단위로 나타냄
    - **Set-Cookie** : 쿠키를 설정할 때 사용됨
    - **Date** : 응답이 생성된 시간을 나타냄

- 빈줄 (Blank Line)

  - 헤더와 바디를 구분하기 위한 빈 줄이 존재한다.

- 바디 (Body)
  - 실제로 클라이언트가 요청한 데이터를 담고 있는 부분.

```bash
HTTP/1.1 200 O
Date: Sun, 29 Sep 2024 12:45:00 GMT
Content-Type: text/html; charset=UTF-8
Content-Length: 1234

<html>
  <head>
    <title>Example Page</title>
  </head>
  <body>
    <h1>Welcome to the Example Page!</h1>
  </body>
</html>
```

### 주요 HTTP 상태 코드

| 상태 코드 | 분류                | 설명                                           |
| --------- | ------------------- | ---------------------------------------------- |
| **1xx**   | **정보**            | **요청이 수신되어 처리 중**                    |
| 100       | Continue            | 클라이언트가 계속 요청을 이어갈 수 있음을 의미 |
| 101       | Switching Protocols | 서버가 요청에 따라 프로토콜을 변경하는 중      |

| 상태 코드 | 분류       | 설명                                                   |
| --------- | ---------- | ------------------------------------------------------ |
| **2xx**   | **성공**   | **요청이 성공적으로 처리됨**                           |
| 200       | OK         | 요청이 성공적으로 처리되었음을 의미                    |
| 201       | Created    | 요청이 성공적으로 처리되었으며, 새로운 리소스가 생성됨 |
| 204       | No Content | 요청이 성공적이지만, 반환할 데이터가 없음              |

| 상태 코드 | 분류              | 설명                                        |
| --------- | ----------------- | ------------------------------------------- |
| **3xx**   | **리다이렉션**    | **추가적인 작업이 필요함**                  |
| 301       | Moved Permanently | 요청한 리소스가 영구적으로 이동됨           |
| 302       | Found             | 요청한 리소스가 임시적으로 다른 위치에 있음 |
| 304       | Not Modified      | 클라이언트에 캐시된 리소스가 여전히 유효함  |

| 상태 코드 | 분류                | 설명                                       |
| --------- | ------------------- | ------------------------------------------ |
| **4xx**   | **클라이언트 오류** | **요청에 문제가 있음**                     |
| 400       | Bad Request         | 잘못된 요청으로 서버가 이를 이해할 수 없음 |
| 401       | Unauthorized        | 인증이 필요함                              |
| 403       | Forbidden           | 서버가 요청을 이해했지만, 승인을 거부함    |
| 404       | Not Found           | 요청한 리소스를 찾을 수 없음               |

| 상태 코드 | 분류                  | 설명                                                |
| --------- | --------------------- | --------------------------------------------------- |
| **5xx**   | **서버 오류**         | **서버에서 요청을 처리하는 중 문제가 발생함**       |
| 500       | Internal Server Error | 서버에서 요청을 처리하는 도중 오류가 발생함         |
| 502       | Bad Gateway           | 서버가 잘못된 응답을 받음                           |
| 503       | Service Unavailable   | 서버가 요청을 처리할 준비가 되지 않음               |
| 504       | Gateway Timeout       | 서버가 다른 서버로부터 응답을 받지 못해 시간 초과됨 |
